Jenkins Security. Матричное распределение прав
(Matrix-based security)

[sources:]
  1) "Matrix Authorization Strategy": https://plugins.jenkins.io/matrix-auth/
  2) "Managing Security": https://www.jenkins.io/doc/book/security/managing-security/

  В этом режиме вы можете явно указать допустимые операции, используя матрицу привилегий.
  Каждая колонка представляет собой привилегию.

'''
  Эта схема авторизации позволяет детально контролировать,
  какие пользователи и группы могут выполнять те или иные действия в среде Jenkins
'''

# Наведите курсор мыши на имя привелегии для получения большей информации о её предназначении.

  Каждая строка представляет собой пользователя или группу (обычно называемая "ролью", в зависимости от используемого модуля безопасности).

  Список включает также СПЕЦИАЛЬНЫЕ ЗАПИСИ (internal groups) с именами
    "анонимный" ("anonymous")
  и
    "аутентифицированный" ("authenticated"). 

  Запись "anonymous" представляет собой неаутентифицированного пользователя, имеющего доступ к среде Jenkins.

  В то время как "authenticated" может использоваться для предоставления разрешений всем аутентифицированным пользователям,
  имеющим доступ к среде.

  Чтобы добавить нового пользователя/группу/роль в таблицу, используйте поле ввода под таблицей.
  Чтобы удалить пользователя/группу/роль нажмите кнопку [x] в правой колонке.

[!] ПРИВИЛЕГИИ АДДИТИВНЫ
      то есть если пользователь X состоит в группах A, B и C,
      тогда реальные привилегии пользователя = объединение всех привилегий, данных
        + конкретно пользователю,
        + группам A, B и C
        + и анонимному пользователю.

```
[ПРИМЕР:]
  если пользователь "kohsuke" входит в группы:
    ✓ "разработчики" 
    ✓ "администраторы",
  то разрешения, предоставленные "kohsuke", будут представлять собой объединение всех разрешений,
  предоставленных:
    + "kohsuke",
    + "разработчикам",
    + "администраторам",
    + "аутентифицированным"
    + "анонимным".
```


#########
# ПРАВА #
#########

--<[Полные]>--

  Administer
    = Это разрешение дает возможность
        ✓ вносить изменения в конфигурацию ВСЕЙ СИСТЕМЫ,
        ✓ выполнять особо важные операции, что равносильно полному доступу к локальной системе
          (в рамках, предоставляемых базовой ОС).

  Read
    = Право на чтение необходимо для просмотра почти всех страниц Jenkins.
      Это право полезно, когда вы не хотите, чтобы неаутентифицированные пользователи видели страницы Jenkins:
        ➜ отмените это право у анонимного пользователя,
        ➜ затем добавьте псевдопользователя «authenticated»
        ➜ и дайте ему доступ на чтение. 

--<[Credentials]>--

  Create
    = необходимо для добавления учетных данных в Credentials Provider.

  Delete
    = необходимо для удаления учетных данных, хранящихся в Credentials Provider.
  
  ManageDomains (Право управления доменами)
    = необходимо для добавления/удаления/настройки доменов доверия Credentials Provider
      (если провайдер доверия поддерживает несколько доменов доверия).

  Update (Разрешение на обновление)
    = необходимо для изменения учетных данных в Credentials Provider.

  View (Право просмотра)
    = необходимо для просмотра учетных данных, хранящихся в Credentials Provider


--<[Agent]>--

  Build
    = Это разрешение позволяет пользователям запускать задания от своего имени НА АГЕНТАХ.

  Configure
    = Это разрешение позволяет пользователям настраивать агентов.

  Connect
    = Это разрешение позволяет пользователям
      ✓ подключать агентов
      ✓ или отмечать их как находящихся в сети.
      Данное разрешение подразумевается в Agent/Disconnect.

  Create
    = Это разрешение позволяет пользователям создавать агентов.

  Delete
    = Это разрешение позволяет пользователям удалять существующих агентов.

  Disconnect
    = Это разрешение позволяет пользователям отключать агентов или помечать их как временно отключенных.

  Provision
    = Выделить новые узлы.


--<[Задача]>--

  Build
    = Это разрешение дает возможность начать новую сборку.

  Cancel
    = Это разрешение дает возможность отменить запланированную || прервать текущую сборку.

  Configure
    = Изменение конфигурации задания.

  Create
    = Создать новое задание.

  Delete
    = Удалить задание.

  Discover
    = Это разрешение предоставляет доступ к Job'ам.
      Оно НИЖЕ по приоритету, чем право на чтение,
      и позволяет перенаправлять анонимных пользователей на страницу входа в систему,
      когда они пытаются получить доступ к url-адресу задания.
      (!) Без этого права они получат ошибку 404 и не смогут узнать названия проектов.
          Это разрешение подразумевается (Задача/Read).

  Move
    = Требуется для перемещения задания из одной папки (или корня Jenkins) в другую.

  Read
    = Просмотреть задание.
      (Вы можете запретить это разрешение, но разрешить Discover,
       чтобы ЗАСТАВИТЬ анонимного пользователя ВОЙТИ В СИСТЕМУ для просмотра задания).

  Workspace
    = Это разрешение дает возможность получить содержимое рабочей области (WORKSPACE),
      которую Jenkins проверил (checked out) для выполнения сборок.
      Если вы НЕ ХОТИТЕ, чтобы пользователь получал доступ к файлам в WORKSPACE
      (например, исходному коду из SCM или промежуточным результатам сборки) через браузер рабочего пространства,
      => вы можете отозвать это разрешение.


--<[Запуск]>--

  Delete
    = Это право позволяет пользователям вручную удалять определенные сборки из истории сборок.

  Replay
    = Возможность выполнить новую сборку Pipeline с отредактированным сценарием.
      Это право подразумевается Задача/Configure (Job/Configure).

  Update
    = Это право позволяет пользователям обновлять описание и другие свойства сборки,
      # например, оставлять заметки о причинах сбоя сборки.


--<[Просмотр]>--

  Configure
    = Это право позволяет изменять конфигурацию представлений (Views).

  Create
    = Это право позволяет создавать новые представления (Views).

  Delete
    = С помощью этого разрешения можно удалять существующие представления (Views).

  Read
    = Это разрешение позволяет пользователям просматривать представления
      (подразумевается общий доступ на чтение).


--<[Система контроля версий]>--

  Tag
    = Это право позволяет пользователям создавать новый тег в репозитории исходного кода для данной сборки.


--<[Metrics]>--

  HealthCheck
    = Это разрешение предоставляет доступ к функциональности проверки работоспособности СЕРВЛЕТА Metrics.
      [!] ПОЖАЛУЙСТА, ИМЕЙТЕ В ВИДУ:
          в зависимости от характера проверок работоспособности в вашей системе,
          это может быть использовано для атаки типа «отказ в обслуживании» (Denial of Service, DOS),
          если учетные данные пользователя с этим правом будут скомпрометированы.


  ThreadDump
    = Это разрешение предоставляет доступ только для чтения (read-only) к thread dump functionality (функции дампа потоков) сервлета Metrics.
      [!] Пожалуйста, имейте в виду, что потенциально конфиденциальная информация в трассировке стека,
          например имена заданий, будет открыта пользователям с этим правом.

  View
    = Это разрешение предоставляет доступ только для чтения (RO) к сервлету Metrics.
      [!] Пожалуйста, имейте в виду, что потенциально конфиденциальная информация в вашей трассировке стека,
          такая как имена заданий, будет открыта более широкой аудитории при предоставлении этого разрешения.


--<[Scriptler]>--

  Configure
    = Разрешить конфигурирование скриптов Scriptler,
      позволять тонкую настройку вместо того, чтобы давать Overall/RunScripts всем желающим.
      Это разрешение подразумевается Полные/RunScripts.
  
  RunScripts
    = Разрешить выполнение скриптов Scriptler и вставку/изменение шагов сборки Scriptler,
      разрешить тонкую настройку вместо предоставления Overall/RunScripts всем желающим.
      Это разрешение подразумевается Полные/RunScripts.

#more:
#-> "Scriptler. Scriptler Plugin for Jenkins": https://plugins.jenkins.io/scriptler/
"""
  Scriptler позволяет хранить/редактировать groovy-скрипты и выполнять их на любом из агентов/узлов... без необходимости копировать/вставлять groovy-код.

  Помимо администрирования скриптов, Scriptler также предоставляет возможность обмена скриптами между пользователями через размещенные в интернете каталоги скриптов.
  На GitHub по адресу https://github.com/jenkinsci/jenkins-scripts/tree/main/scriptler вы можете
    не только найти скрипты и импортировать их через Scriptler в свой экземпляр Jenkins,
    но и поделиться своими собственными скриптами.
    Просто отправьте pull request на https://github.com/jenkinsci/jenkins-scripts/,
    и ваши скрипты будут доступны всем остальным.
"""


*******************
* Предостережения *
*******************

  При использовании МАТРИЧНОЙ АВТОРИЗАЦИИ НА ОСНОВЕ ПРОЕКТА (Project-based Matrix Authorization Strategy)
  пользователи, получившие разрешение на настройку элементов или агентов, смогут предоставлять себе все остальные разрешения на элемент или агент.
  Они будут наследоваться, если не будут специально отключены.

[!] Помимо вышесказанного, администраторы, реализующие тонкий контроль разрешений,
    должны знать о взаимодействии между разрешениями и об их определенном дублировании.

Некоторые примеры:
  ● Пользователь, которому не предоставлен доступ на чтение К JENKINS В ЦЕЛОМ (read access to Jenkins in general),
    НЕ СМОЖЕТ ИСПОЛЬЗОВАТЬ большинство других предоставленных ему прав
    => скорее всего, ни одного из них.

  ● Пользователь, которому не предоставлен доступ на чтение К ЗАДАНИЮ,
    не сможет запускать новые сборки, удалять задания, настраивать их и т. д.

  ● При использовании глобальной матричной авторизации пользователи, получившие
     + право НАСТРАИВАТЬ задания,
     - но НЕ ЗАПУСКАТЬ их,
   все равно СМОГУТ НАСТРОИТЬ ЗАДАНИЕ на периодическое выполнение.


[*] Некоторые права подразумевают другие.
    Прежде всего, разрешение Overall/Administer подразумевает (почти) все остальные разрешения,
    но существуют и другие последствия:
  Например,
   -> Job/Read =(подразумевает)=> Job/Discover.

   В описаниях разрешений будет указано, когда разрешение
     -> либо подразумевается каким-либо другим разрешением, кроме Overall/Administer,
     -> либо не подразумевается никаким другим разрешением.