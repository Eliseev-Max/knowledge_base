У нас была эта проблема довольно долгое время с нашим Jenkins за прокси нашей компании. На днях они изменили порядок схем аутентификации, которые требует наш прокси. В этот день наш Jenkins перестал подключаться к интернету.

Очевидно, что Jenkins не может подключиться через прокси, который требует NTML аутентификации. Это заставило меня выпустить улучшение для Jenkins, чтобы расширить экран конфигурации прокси. Во время работы над расширением я обнаружил, что Jenkins не использует все системные свойства, связанные с прокси, поэтому он не может работать с NTLM.

Поэтому ответ для прокси, который позволяет только NTLM аутентификацию, таков: он не будет работать через пользовательский интерфейс Jenkins.

Но если ваш прокси позволяет другие схемы аутентификации, вы можете следовать нашему обходному пути, который довольно прост: добавьте системное свойство java -Dhttp.auth.preference="basic" в сценарий запуска Jenkins или в контейнер.

Это заставит базовые библиотеки и механизмы Java, используемые Jenkins, подключаться к вашему прокси с помощью базовой аутентификации, а не NTLM.

Чтобы выделить

    Поддерживаемые схемы аутентификации в порядке предпочтения: ntlm, digest, basic
    схема аутентификации ntlm выбрана автоматически http-клиентом apache

Таким образом, в нашем случае мы могли бы обойти все эти проблемы, если бы на странице прокси была возможность определить схему аутентификации, которую должен использовать http-клиент. Если я найду время, я посмотрю, смогу ли я предложить запрос на исправление.

https://issues.jenkins.io/browse/JENKINS-32293

https://stackoverflow.com/questions/29682844/jenkins-proxy-407-error

https://www.securitylab.ru/contest/212100.php