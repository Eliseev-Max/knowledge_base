Команда lsof (LiSt Open Files)
(sources:
  1. https://zalinux.ru/?p=3535
  2. https://manpages.ubuntu.com/manpages/bionic/man8/lsof.8.html)

#################################
## В Linux всё является файлом ##
#################################

lsof позволяет просматривать устройства и процессы, которые обрабатываются, как файлы.

Файл представляет собой набор байтов.
Программы и устройства (принтер, экран, клавиатура, мышь, терминал, сетевая карта) могут генерировать или принимать потоки байт
→ в этом качестве они сами проявляются как файлы.
Многие системные компоненты, такие как клавиатуры, сокеты, принтеры и коммуникационные процессы, принимают или генерируют потоки байтов.
Кроме обычных файлов, файлами также являются:
	• директории (папки),
	• сетевые сокеты (подключения по сети),
	• устройства:
	  •• диски,
	  •• терминалы,
	  •• клавиатура,
	  •• мышь и прочее
	— это всё файлы,
	• pipe (технология обмена данными между процессами)

[ Открытый файл может быть
  - обычным файлом,
  - каталогом,
  - специальным файлом блока,
  - специальным файлом символа,
  - исполняемой текстовой ссылкой,
  - библиотекой,
  - потоком или сетевым файлом (интернет-сокет, файл NFS или сокет домена UNIX)

]

‼ Эта концепция устройства упростила реализацию операционной системы Unix:
	небольшой набор обработчиков, инструментов и API-интерфейсов может быть создан для обработки широкого спектра различных ресурсов.

Команда ls - информация о файлах, находящихся в файловой системе (на диске).
Команда lsof - информация обо всех других процессах и устройствах, которые рассматриваются как файлы.
	Она выводит списки открытых файлов в системе = она перечисляет всё, что обрабатывается, как если бы это был файл.

► Команда lsof используется чтобы узнать, какие файлы открыты и каким процессом.

[?] Для чего нужно знать, какие файлы открыты?
[!] Эта информация поможет узнать о многом происходящем в системе, об устройстве и работе Linux,
    + помогает решить проблемы, например, когда вы не можете размонтировать диск из-за того, что устройство используется, но вы не можете найти, какой именно программой.

[‼] Многие процессы или устройства, о которых lsof может сообщать, принадлежат root или были запущены пользователем root,
 → поэтому вам нужно будет использовать команду sudo с lsof.

#########################################################################################################################
	Использование команды lsof

Поскольку список открытых файлов может быть слишком длинным, можно передать вывод команде less
	$ sudo lsof | less

Значение столбцов lsof

    • COMMAND: Имя команды, связанной с процессом, который открыл файл.
    • PID: Идентификационный номер процесса, который открыл файл.
    • TID: Идентификационный номер задачи (потока) . Пустой столбец означает, что это не задача; это процесс.
    • TASKCMD: это имя команды задачи. Обычно это будет то же самое, что и процесс, названный в столбце COMMAND,
	    но некоторые реализации задач (например, Linux) позволяют задаче изменить имя своей команды.
    • USER: это идентификационный номер пользователя или логин пользователя, которому принадлежит процесс, обычно то же самое, что сообщает ps. Однако в Linux USER — это идентификационный номер пользователя или логин, который владеет каталогом в /proc, где lsof находит информацию о процессе. Обычно это то же самое значение, которое сообщает ps, но может отличаться, если процесс изменил свой эффективный идентификатор пользователя (также смотрите Что такое файловая система /proc в Linux)
    • FD: показывает файловый дескриптор файла. Файловые дескрипторы описаны ниже.
    • TYPE: тип узла, связанного с файлом. Виды данных типов описаны ниже.
    • DEVICE: содержит номера устройств, разделённые запятыми, для специальных символьных, специальных блочных, обычных файлов, каталогов или NFS. Также может отображаться базовый адрес или имя устройства с сокетом Linux AX.25.
    • SIZE/OFF: Показывает размер файла или смещение файла в байтах.
    • NODE: Показывает номер узла локального файла или номер узла NFS-файла на хосте сервера или тип интернет-протокола. Может отображаться STR для потока, IRQ или номер инода устройства с сокетом Linux AX.25.
    • NAME: для обычных файлов показывает имя точки монтирования и файловой системы, в которой находится файл. Для других типов файлов здесь указываются специфичные для них данные, подробности будут даны ниже.
