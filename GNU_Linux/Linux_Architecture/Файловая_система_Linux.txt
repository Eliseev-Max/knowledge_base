Файловая система Linux
(конспект статьи https://losst.ru/fajlovaya-sistema-linux)

Файловой системой называют
	- Вся структура каталогов Linux, начиная с корня (/);
    - Конкретный формат раздела хранения данных, например, Ext3, Ext4, Btrfs, XFS и так далее.
		(Ядро Linux поддерживает более 100 типов файловых систем, в том числе очень старых и новых.)
		Каждый тип файловой системы использует свои структуры метаданных чтобы организовать работу с данными на диске;
    - Раздел или логический том, отформатированный в определенный тип файловой системы, который можно примонтировать
	  к определенной точке монтирования.
	
Основные функции файловой системы
Основная функция файловой системы - предоставление организованного пространства для хранения файлов на энергонезависимом запоминающем устройстве.
Основная цель файловой системы — представлять и организовывать ресурсы хранения системы. [E.Nemeth,... UNIX and Linux system administration handbook]

Все файловые системы должны обеспечивать пространство имен.
Оно определяет:
	* как будут называться файлы,
	* ограничения на длину имени,
	* используемые символы, 
	* логическую структуру данных на диске (использование каталогов для организации файлов, а не просто складывания их в одном месте)
				
Пространство имён определено ► создать основу для пространства имён с помощью метаданных файловой системы

Состав метаданных файловой системы:
	* структура данных для создания иерархии каталогов;
	* структура для хранения занятых и свободных блоков на диске;
	* структура с именами файлов и каталогов;
	* информация о файлах, такая как:
		• размер,
		• время создания,
		• расположение файла на диске
			и так далее

	В самих блоках файла на диске хранится ТОЛЬКО ЕГО СОДЕРЖИМОЕ.
	Вся же остальная информация находится в метаданных.
	[    Блок файла    ]	 [ 	 	   Метаданные 	    ]
	 |содержимое файла|	      |вся остальная информация|

Также метаданные используются: 
	* для описания логических томов и подразделов (если таковые поддерживаются);
	* метаданные содержат информацию, описывающую файловую систему

Для доступа к файлам также необходим набор ФУНКЦИЙ API,
с помощью которых программы могли бы управлять различными объектами файловой системы:
	* методы создания файлов;
	* методы перемещения файлов;
	* методы удаления файлов

Современные файловые системы также обеспечивают модель безопасности,
которая представляет из себя схему прав доступа к файлам для пользователей.
Модель безопасности ФС в Linux гарантирует что пользователи будут иметь доступ только к своим файлам.

Организация файловой системы Linux состоит из двух частей:
1. виртуальная файловая система. 
	Она представляет собой единый набор команд ядра, с помощью которого разработчики могут получить доступ к любой из файловых систем.
	Виртуальной файловой системе необходим драйвер для работы с различными типами ФС.
2. драйвера файловой системы.
	В них реализован стандартный набор команд, выполняющих специфичные для файловой системы действия.

Структура файловой системы Linux иерархическая.
Все каталоги находятся в корневом каталоге (/).

Корневая файловая система Linux - это ФС верхнего уровня.
Она должна содержать все файлы, необходимые для загрузки Linux еще до того как другие файловые системы будут смонтированы.
Здесь уже должны быть все исполняемые файлы и библиотеки, нужные для подключения других ФС.
Во время загрузки другие файловые системы монтируются в четко определенные для них каталоги.

Каталоги
		/bin	╖
		/dev	║
		/etc	║
		/lib	║
		/root	║
		/sbin	╜
			  • не могут быть примонтированы
			  • должны быть доступны еще до загрузки (в них находятся все необходимые файлы) 
			  
Каталоги 
		 /media ╖
		 /mnt 	╜
			   должны быть пустыми, поскольку это точки монтирования для других файловых систем.

Остальные каталоги можно смело монтировать позже, они никак не повлияют на запуск.

Директория /bin
	* Бинарные файлы (= исполняемые файлы) являются файлами, содержащими скомпилированный исходный код (или машинный код).
	* Бинарные файлы могут исполняться на компьютере
	Директория /bin содержит бинарные файлы, которые могут использоваться ВСЕМИ пользователями.
	В соответствии со спецификацией FHS, директория /bin должна содержать исполняемые файлы
		• /bin/cat
		• /bin/date (помимо других исполняемых файлов)
	Многие исполняемые файлы директории /bin являются реализациями команд (= утилиты), например:
		• cat
		• cp
		• date
		• dd
		• echo
		• grep
		• ...
	
	Во многих директориях содержатся поддиректории /bin
	(Например: /home/user/bin	- поддиректория, содержащая собственные приложения пользователя)
	Файлы некоторых приложений, обычно в случае установки путем непосредственной сборки из исходного кода,
	устанавливаются в директорию /opt.
	Пример: поддиректория для хранения бинарных файлов при установке сервера samba:
		/opt/samba/bin

Директория /sbin
	Директория /sbin содержит бинарные файлы, предназначенные для настройки операционной системы.
	Многие из бинарных файлов для настройки системы требуют наличия привилегий пользователя root для выполнения определенных задач.
	Пример:
		/sbin/ifconfig		# бинарный файл, предназначенный для изменения IP-адреса
		/sbin/fdisk			# бинарный файл, предназначенный для работы с разделами жёстких дисков
		/sbin/mkfs.ext4		# бинарный файл, предназначенный для создания файловой системы ext4
	
Директория /lib
	Бинарные файлы из директорий /bin и /sbin обычно используют разделяемые библиотеки, расположенные в директории /lib

Поддиректория /lib/modules
	Обычно ядро Linux загружает модули из директории /lib/modules/$версия-ядра/

Директория /boot
...
Директория /etc
	/etc содержит все специфичные для машины конфигурационные файлы.
	Изначально имя директории /etc была образовано от слова etcetera (и так далее).
	Сегодня люди часто расшифровывают его как Editable Text Configuration.
	Во многих случаях имена конфигурационных файлов совпадают с именами приложений или протоколов,
	а в качестве расширений этих файлов используется строка .conf. 

	/etc/init.d/	содержит сценарии для запуска и остановки демонов.

Директория /dev		(= devices, файлы устройств)
	Все подключенные устройства = файлы в каталоге /dev/
	Структура файловой системы Linux и содержащиеся в папке /dev файлы инициализируются при загрузке системы, сервисом udev.
	Выполняется сканирование всех подключенных устройств и создание для них специальных файлов.
	Это такие устройства, как:
		* /dev/sda,
		* /dev/sr0,
		* /dev/tty1,
		* /dev/usbmon0 	и т д.

Директория /var
	
	/var/log/
	/var/lib/
	

Типы файловых систем

Основные файловые системы Linux:
    btrfs;
    cramfs;
    ext2;
    ext3;
    ext4;
    fat;
    gfs2;
    hfsplus;
    minix;
    msdos;
    ntfs;
    reiserfs;
    vfat;
    xfs.

Монтирование файловых систем
Точка монтирования - это обычный каталог, как любая другая часть файловой системы.
(Например, домашняя папка смонтирована в каталог /home)

Другие файловые системы (помимо корневой /) монтируются системой инициализации, например, SysVinit или Systemd.
Точки монтирования настраиваются с помощью файла /etc/fstab.
Также можно выполнять ручное монтирование в Linux с помощью команды mount.
Каталог для монтирования необязательно должен быть пустым, он может содержать файлы, но тогда они будут просто скрыты.
