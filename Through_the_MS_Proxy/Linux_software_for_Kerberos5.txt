Утилиты Linux для работы с Kerberos 5.

1. Kerberos for Ubuntu
  {https://computing.help.inf.ed.ac.uk/kerberos-ubuntu}
  
  1. Установка пакета krb5-user:
  $ sudo apt-get install krb5-user
  # Ввести пароль. Когда появится запрос на продолжение, нажмите Y, а затем Enter.
  # Будет предложено ввести стандартную зону Kerberos 5. Введите INF.ED.AC.UK (все прописные буквы)
  # В нашем случае - PROSOFT.URAL.RU
  
  2. Использование Kerberos
	Чтобы использовать службы с аутентификацией Kerberos, сначала необходимо получить билет с помощью команды kinit.
	Билеты будут уничтожены:
		• при перезагрузке компьютера,
		• при выполнении команды kdestroy
		• по истечении срока действия.
	Вам нужно будет снова запустить kinit после любого из этих событий.
	В зависимости от конфигурации вашего клиента Kerberos вам может потребоваться добавить флаг -f для запроса пересылаемого билета.
	Опция -f = получить билет с возможностью пересылки на другой хост.
	
	Выполнить команду:
		$ kinit -f m.eliseev
		> Password for m.eliseev@PROSOFT.URAL.RU:
	# В случае успеха команда не выдаст никаких результатов.
	# ‼ Если по умолчанию у вас установлена другая сфера, добавьте @PROSOFT-E.RU к вашему имени пользователя.
	
	Команда kinit принимает ряд опций
	  → для изменения срока действия вашего билета,
	  → для изменения срока его продления,
	  → а также опций для пересылки и проксирования.
	  Подробнее: man kinit
	Чтобы проверить, перечислить или показать все ваши билеты, выполните команду klist:

---
Статья "Kerberos" от Ubuntu.ru
{https://help.ubuntu.ru/wiki/%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE_%D0%BF%D0%BE_ubuntu_server/%D0%B0%D0%B2%D1%82%D0%BE%D1%80%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F_%D0%BF%D0%BE_%D1%81%D0%B5%D1%82%D0%B8/kerberos#%D0%BE%D0%B1%D0%B7%D0%BE%D1%80}

Kerberos это система сетевой аутентифиации, основанная на принципах доверия третьей стороне.
Другие две стороны - это пользователь и сервис, на котором он хочет авторизоваться.
Не все сервисы и приложения могут использовать Kerberos, но те, которые могут, приближают сетевое окружение на один шаг к технологии единого входа (Single Sign On - SSO).

Основные термины:

	• Учетная запись (Principal): любые пользователи, компьютеры или сервисы, предоставляемые серверами, должны быть определены как учетные записи Kerberos.
    • Требования (Instances): используются для сервисных и специальных административных учетных записей.
	• Области (Realms): уникальная область управления, обеспечиваемая установкой Kerberos.
	    ~ домен или группу ваших компьютеров и пользователей, ей принадлежащих.
		По умолчанию Ubuntu использует имя DNS домена в верхнем регистре (EXAMPLE.COM) в качестве имени области.
	• Центр распространения ключей (Key Distribution Center, KDC): состоит из трех частей:
		♦ базы данных всех учетных записей,
		♦ сервера аутентификации
		♦ сервера предоставления билетов.
		Для каждой области должен быть хотя бы один KDC.
	• Билет для получения билета (TGT): изданный сервером аутентификации, TGT зашифровывается на пароле пользователя, который известен только пользователю и KDC.
	• Сервер распространения билетов (TGS): выпускает сервисные билеты для клиентов по запросу.
	• Билеты (Tickets): подтверждение идентичности двух учетных записей.
	  Одна учетная запись - пользователь, а другая - сервис, запрашиваемый этим пользователем.
	  Билеты устанавливают секретный ключ, используемый для защищенного соединения во время авторизованной сессии.

    Файлы ключей (Keytab Files): файлы, извлеченные из базы учетных записей KDC и содержащие ключ шифрования для сервиса или компьютера.

Чтобы сложить все вместе: Область содержит как минимум один KDC, лучше больше для обеспечения безотказности, которые содержат базу данных учетных записей. Когда пользователь под учетной записью заходит на рабочую станцию, которая настроена на Kerberos аутентификацию, KDC выпускает билет для получения билетов (TGT). Если пользователь предоставляет совпадающие параметры, он считается аутентифицированным и может запрашивать билеты для сервисов, поддерживающих Kerberos, на сервере распространения билетов (TGS). Сервисные билеты позволяют пользователю аутентифицироваться на сервисах без ввода имени и пароля. 


---
Получение билетов с помощью программы kinit
	Для зарегистрированных пользователей:
	$ kinit
	Password for user@domain.org: <Пароль_пользователя>

	Если был введён неверный пароль, kinit выведет:
	kinit: Password incorrect
	
	Пароль для пользователя, не зарегистрированного в данном домене (зарегистрированного в другом домене):
	kinit alien@another.domain.ru

	Если вы хотите иметь возможность пересылать свои билеты на другой хост,
	вам нужно запросить билеты с возможностью пересылки.
	Для этого нужно указать параметр -f:
		$ kinit -f

	kinit не сообщает вам, что он получил билеты с возможностью пересылки;
	можно проверить это с помощью команды klist

Указываем время жизни билетов:
	$ kinit -f -l [lifetime] user@domain.org
# lifetime - время жизни билетов:
	(int)d - количество дней;
	(int)h - количество часов;
	(int)m - количество минут;
	(int)s - количество секунд;
	#int = некоторое целое число
---