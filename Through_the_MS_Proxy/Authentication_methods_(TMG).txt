{ About authentication methods
	http://certsrv.ru/tmg.en/html/dd1b9960-6e74-4351-bfea-688c96b87f89.htm#bkmk_httpauthentication
  Overview of authentication in Forefront TMG:
	http://certsrv.ru/tmg.en/html/c32f2515-e57a-43af-ba3c-a30d75d384ca.htm
}

Методы аутентификации, используемые Forefront TMG
	• HTTP-аутентификация 
	• Аутентификация на основе форм
	• Аутентификация с помощью клиентского сертификата

Типы HTTP-аутентификации:
	♦ базовая аутентификация;
	♦ Digest и WDigest аутентификация;
	♦ Встроенная аутентификация Windows

► Базовая аутентификация - это широко используемый метод сбора информации об имени пользователя и пароле.
  Базовая аутентификация отправляет и получает информацию о пользователе в виде текстовых символов, которые можно прочитать.
  Хотя пароли и имена пользователей кодируются, при базовой аутентификации ШИФРОВАНИЕ НЕ ИСПОЛЬЗУЕТСЯ.

  Следующие шаги описывают, как происходит аутентификация клиента с помощью базовой аутентификации:

    1. Пользователю предлагается ввести имя пользователя и пароль учетной записи Windows.
	2. Forefront TMG:
		• получает HTTP-запрос с учетными данными
		•• проверяет их на указанном сервере проверки подлинности 
		(RADIUS или Active Directory Domain Services (AD DS), сервер LDAP только для входящих запросов).
	3. Для исходящих запросов веб-прокси Forefront TMG проверяет учетные данные, а затем оценивает правила доступа.
	   Для входящих запросов Forefront TMG использует учетные данные для проверки подлинности на опубликованном веб-сервере в соответствии с настроенным методом делегирования.
	   Веб-сервер должен быть настроен на использование схемы проверки подлинности, соответствующей методу делегирования, используемому Forefront TMG.
	   Пароль в открытом виде кодируется Base64 перед отправкой по сети; однако это не шифрование, и если пароль будет перехвачен по сети сетевым сниффером, неавторизованные пользователи смогут расшифровать и повторно использовать пароль.

  Преимущество базовой аутентификации:
	+ она поддерживается почти всеми HTTP-клиентами.

  Недостатки базовой аутентификации:
	- веб-браузеры, использующие базовую аутентификацию, передают пароли в незашифрованном виде.

Вывод: базовая аутентификация ‼не рекомендуется‼, если вы не уверены в безопасности соединения
Наблюдая за коммуникациями в вашей сети, злоумышленник или злонамеренный пользователь может перехватить и расшифровать эти пароли с помощью общедоступных инструментов.

► Digest и WDigest аутентификация

	Digest-аутентификация предлагает те же возможности, что и Basic-аутентификация, но обеспечивает более безопасный способ передачи учетных данных для аутентификации.

	Digest-аутентификация основана на протоколе HTTP 1.1, определенном в RFC 2617 (http://go.microsoft.com/fwlink/?LinkId=160622). Он поддерживается не всеми браузерами. Если браузер, не поддерживающий протокол HTTP 1.1, запрашивает файл при включенной аутентификации Digest, запрос будет отклонен. Аутентификация Digest может использоваться только в доменах Windows.

	Дайджест-аутентификация успешна только в том случае, если контроллер домена имеет обратимо зашифрованную (простой текст) копию пароля запрашивающего пользователя, хранящуюся в AD DS. Чтобы разрешить хранение паролей в открытом виде, необходимо активировать параметр Хранить пароль с помощью настройки обратимого шифрования на вкладке Учетная запись пользователя в AD DS. Кроме того, можно настроить групповую политику для включения этой возможности. После настройки этого параметра необходимо задать новый пароль для активации этой функции, поскольку старый пароль невозможно определить.

	WDigest, новая форма Digest-аутентификации, используется, когда Forefront TMG установлен в домене Windows Server 2008. WDigest не требует хранения обратимо зашифрованной копии пароля пользователя в AD DS.

	Аутентификация Digest и WDigest работает следующим образом:
		
	1. Клиент делает запрос.
	2. Forefront TMG отклоняет запрос и предлагает клиенту ввести имя пользователя и пароль учетной записи Windows. Обратите внимание, что при использовании WDigest имя пользователя и имя домена чувствительны к регистру и должны быть записаны точно так, как они отображаются в AD DS. Кроме того, WDigest требует значения в ресурсной части пути URL. Например, запрос пользователя http://host.domain.tld не выполняется, поскольку ресурс URL отсутствует.

    3. Учетные данные аутентификации проходят через односторонний процесс, известный как хэширование. В результате получается зашифрованный хэш или дайджест сообщения. Значения добавляются для идентификации пользователя, его компьютера и домена. Чтобы пользователь не смог использовать пароль после того, как он был отозван, добавляется временная метка. Это дает явное преимущество перед базовой аутентификацией, поскольку неавторизованному лицу сложнее перехватить или использовать пароль.
	